import{r as o,j as e,a as p}from"./react-BkjPoRIh.js";import{c as U}from"./react-dom-DWN0RgAt.js";import{B as I}from"./react-router-dom-CyiGHeXB.js";import{a as h}from"./axios-Cm0UX6qg.js";import{J as P}from"./jszip-C_GpTb5M.js";import{F as z}from"./file-saver-B00IKLHc.js";import{u as f,a as A,b as j}from"./react-router-D3GXQn_V.js";import"./scheduler-CzFDRTuY.js";import"./@remix-run-Dql683DL.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))c(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const n of a.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&c(n)}).observe(document,{childList:!0,subtree:!0});function l(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function c(r){if(r.ep)return;r.ep=!0;const a=l(r);fetch(r.href,a)}})();const b=o.createContext({messages:[],addMessage:()=>{}}),F=({children:s})=>{const[l,c]=o.useState([]),r=a=>{const n=JSON.stringify(a);console.log("+++ Inside MessageProvider => "+n),c(u=>[...u,n])};return e.jsx(b.Provider,{value:{messages:l,addMessage:r},children:s})},x=()=>o.useContext(b),_=()=>{const[s,l]=o.useState([]),[c,r]=o.useState(!1),a=o.useRef(null),n=o.useRef(null),[u,y]=o.useState(0),[v,g]=o.useState(!0),E=f(),{addMessage:d}=x(),L=async()=>{try{const t=await h.get("https://192.168.1.110:8080/photo.jpg",{responseType:"blob"});if(z.saveAs(t.data,"captura.jpg"),n.current){const i=URL.createObjectURL(t.data);n.current.src=i}}catch(t){console.error("Error al capturar la imagen:",t),d("Error al capturar la imagen:"+t)}};o.useEffect(()=>(c?a.current=setInterval(C,1e3):clearInterval(a.current),()=>{a.current&&clearInterval(a.current)}),[c]);const C=async()=>{try{const t=await h.get("https://192.168.1.110:8080/photo.jpg",{responseType:"blob"});if(l(i=>[...i,t.data]),n.current){const i=URL.createObjectURL(t.data);n.current.src=i}}catch(t){console.error("Error al capturar la imagen:",t),d("Error al capturar la imagen:"+t)}},R=()=>{r(!0)},k=()=>{r(!1),N()},N=()=>{const t=new P;s.forEach((i,m)=>{t.file(`captured_frame_${m}.jpg`,i)}),t.generateAsync({type:"blob"}).then(i=>{const m=document.createElement("a");m.href=URL.createObjectURL(i),m.download="captured_frames.zip",m.click()})},S=()=>{E("/debug")},w=()=>{y(u+1),O()},M=()=>{console.log("La imagen se ha cargado correctamente."),d("La imagen se ha cargado correctamente.")},O=async()=>{try{const t=await fetch("https://192.168.1.110:8080/video");t.ok?g(!0):(g(!1),console.error("Error al obtener la imagen. C\xF3digo de estado:",t.status),d("Error al obtener la imagen. C\xF3digo de estado: "+t.status))}catch(t){g(!1),console.error("Error al obtener la imagen:",t),d("Error al capturar la imagen:"+t)}};return e.jsxs("div",{children:[v?e.jsxs(e.Fragment,{children:[e.jsx("img",{ref:n,src:"https://192.168.1.110:8080/video",alt:"Video Stream",width:"529",height:"297",onLoad:M,onError:t=>{d("Error al capturar la imagen:"+t.message)}},u),e.jsxs("h2",{children:["Contador: ",u]}),e.jsx("button",{onClick:L,children:"Capturar una imagen"}),e.jsx("button",{onClick:R,children:"Comenzar capturaci\xF3n"}),e.jsx("button",{onClick:k,children:"Parar capturaci\xF3n"})]}):e.jsx("p",{children:"La URL no es v\xE1lida o hay un problema de conexi\xF3n."}),e.jsx("button",{onClick:w,children:"Refresh"}),e.jsx("button",{onClick:S,children:"Debug"})]})},B=()=>{const{messages:s}=x(),l=f(),c=()=>{l("/")};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"debug-container",children:e.jsxs("div",{className:"debug-container-grid",children:[e.jsx("div",{className:"debug-container-grid-item-traza",children:e.jsx("ul",{children:s.map((r,a)=>r&&e.jsx("li",{children:r},a))})}),e.jsx("div",{className:"debug-container-grid-item-input-btns",children:e.jsx("div",{className:"debug-container-grid-item-input-field",children:e.jsx("div",{className:"input-group mb-3",children:e.jsx("button",{onClick:c,children:"Volver"})})})})]})})})};function V(){return e.jsx(p.StrictMode,{children:e.jsx(F,{children:e.jsx(I,{basename:"/react-webcam",children:e.jsxs(A,{children:[e.jsx(j,{path:"/",element:e.jsx(_,{})}),e.jsx(j,{path:"/debug",element:e.jsx(B,{})})]})})})})}U.createRoot(document.getElementById("root")).render(e.jsx(p.StrictMode,{children:e.jsx(V,{})}));
